<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>中小学生精神状态调查问卷</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft Yahei", Arial, sans-serif;
        }
        body {
            background-color: #f0f2f5;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .survey-container {
            max-width: 560px;
            width: 100%;
            background: #fff;
            padding: 35px 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.12);
        }
        .question-title {
            font-size: 19px;
            font-weight: 600;
            color: #222;
            margin-bottom: 22px;
            line-height: 1.4;
        }
        .option-item {
            display: flex;
            align-items: center;
            margin-bottom: 14px;
            font-size: 16px;
            color: #333;
            cursor: pointer;
        }
        .option-item input {
            margin-right: 11px;
            width: 17px;
            height: 17px;
            cursor: pointer;
        }
        .next-btn, .submit-btn {
            width: 100%;
            height: 46px;
            border: none;
            border-radius: 6px;
            font-size: 17px;
            font-weight: 500;
            cursor: pointer;
            margin-top: 28px;
            background-color: #4066ff;
            color: #fff;
            transition: background 0.2s ease;
        }
        .next-btn:hover, .submit-btn:hover {
            background-color: #3356e8;
        }
        .result-page {
            max-width: 560px;
            width: 100%;
            background: #fff;
            padding: 35px 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.12);
            display: none;
        }
        .result-title {
            font-size: 22px;
            font-weight: 700;
            color: #222;
            text-align: center;
            margin-bottom: 10px;
        }
        .score-desc {
            font-size: 16px;
            color: #555;
            text-align: center;
            margin: 18px 0 25px;
            line-height: 1.6;
        }
        .chart-box {
            width: 100%;
            height: 320px;
            margin: 0 auto;
        }
        .answer-tip {
            color: #ff4444;
            font-size: 14px;
            margin-top: 12px;
            display: none;
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- 问卷主体容器 -->
    <div class="survey-container" id="surveyContainer"></div>
    <!-- 提交提示 -->
    <div class="answer-tip" id="tip">请选择至少一个选项再继续~</div>
    <!-- 结果页面 -->
    <div class="result-page" id="resultPage">
        <h2 class="result-title">你的精神状态评分</h2>
        <p class="score-desc" id="scoreText"></p>
        <div class="chart-box">
            <canvas id="resultChart"></canvas>
        </div>
    </div>

    <script>
        // 问卷题库配置（含题型、选项、逆天分值）
        const surveyQuestions = [
            {
                id: 1,
                title: "您的性别是【单选】",
                type: "single",
                options: [
                    {label: "A. 男", value: "A", score: 1},
                    {label: "B. 女", value: "B", score: 1},
                    {label: "C. 无性", value: "C", score: 3},
                    {label: "D. 狗", value: "D", score: 5},
                    {label: "E. 猫", value: "E", score: 5},
                    {label: "F. 类人种", value: "F", score: 6},
                    {label: "G. 坦克", value: "G", score: 8},
                    {label: "H. 弹道导弹", value: "H", score: 9},
                    {label: "I. 沃尔玛购物袋", value: "I", score: 10},
                    {label: "J. 窗帘", value: "J", score: 10}
                ]
            },
            {
                id: 2,
                title: "请问您的年级是【单选】",
                type: "single",
                options: [
                    {label: "A. 我是高一", value: "A", score: 1},
                    {label: "B. 我是高二", value: "B", score: 1},
                    {label: "C. 我是高三", value: "C", score: 3},
                    {label: "D. 我想退学", value: "D", score: 7}
                ]
            },
            {
                id: 3,
                title: "请问您对学校管理的评价是【单选】",
                type: "single",
                options: [
                    {label: "A. 很好", value: "A", score: 1},
                    {label: "B. 什么寄吧学校", value: "B", score: 8},
                    {label: "C. 我是校长", value: "C", score: 5},
                    {label: "D. 我只是个草履虫，关我什么事", value: "D", score: 9}
                ]
            },
            {
                id: 4,
                title: "请问上了高中后对您的生活产生了什么影响【多选】",
                type: "multiple",
                options: [
                    {label: "A. 我的精神状态挺好的呀!我的神精状态挺呀的好!的我神精态状好呀挺的!", value: "A", score: 6},
                    {label: "B. 人生毫无意义", value: "B", score: 7},
                    {label: "C. 啊啊啊啊啊啊啊", value: "C", score: 8},
                    {label: "D. 劳资一拳干爆地球", value: "D", score: 10},
                    {label: "E. 哥们想吃人", value: "E", score: 10},
                    {label: "F. （尖叫）（扭曲）（阴暗的爬行）（尖叫）（痉挛）（狂奔）（不分对象攻击）", value: "F", score: 10},
                    {label: "G. 我只是个无忧无虑的草履虫而已", value: "G", score: 8}
                ]
            },
            {
                id: 5,
                title: "您上课的状态【单选】",
                type: "single",
                options: [
                    {label: "A. 这是什么?床?浅睡一下", value: "A", score: 4},
                    {label: "B. 吗的怎么又上课了", value: "B", score: 6},
                    {label: "C. 哥们在坐牢", value: "C", score: 8},
                    {label: "D. 我都说了我是草履虫!草履虫上什么课!", value: "D", score: 10}
                ]
            },
            {
                id: 6,
                title: "如果你被老师批评了，你会?【多选】",
                type: "multiple",
                options: [
                    {label: "A. 将功补过", value: "A", score: 1},
                    {label: "B. bear", value: "B", score: 7},
                    {label: "C. 吃掉老师", value: "C", score: 10},
                    {label: "D. 炸学校解气", value: "D", score: 10},
                    {label: "E. 摆烂", value: "E", score: 6},
                    {label: "F. 大四老师", value: "F", score: 5}
                ]
            },
            {
                id: 7,
                title: "你平常怎么去学校?【多选】",
                type: "multiple",
                options: [
                    {label: "A. 走路", value: "A", score: 1},
                    {label: "B. 开车", value: "B", score: 2},
                    {label: "C. 摇花手飞过去", value: "C", score: 9},
                    {label: "D. 我是微生物不用上学", value: "D", score: 10},
                    {label: "E. 我是草履虫不用上学", value: "E", score: 10},
                    {label: "F. 学校被炸了不用上学", value: "F", score: 10},
                    {label: "G. 骑同学上学", value: "G", score: 8},
                    {label: "H. 有私人专车", value: "H", score: 3}
                ]
            }
        ];

        let currentQuesIndex = 0; // 当前题目索引
        let totalScore = 0; // 总逆天分值
        let userAnswers = []; // 存储用户所有答案

        // 初始化当前题目渲染
        renderCurrentQuestion();

        // 渲染当前题目
        function renderCurrentQuestion() {
            const container = document.getElementById("surveyContainer");
            const currentQues = surveyQuestions[currentQuesIndex];
            let optionsHtml = "";
            const inputType = currentQues.type === "single" ? "radio" : "checkbox";
            const nameAttr = `ques_${currentQues.id}`;

            // 拼接选项DOM
            currentQues.options.forEach(opt => {
                optionsHtml += `
                <div class="option-item">
                    <input type="${inputType}" name="${nameAttr}" id="${nameAttr}_${opt.value}" value="${opt.score}" />
                    <label for="${nameAttr}_${opt.value}">${opt.label}</label>
                </div>
                `;
            });

            // 拼接按钮（最后一题显示提交，其余显示下一题）
            const btnText = currentQuesIndex === surveyQuestions.length - 1 ? "提交问卷" : "下一题";
            const btnClass = currentQuesIndex === surveyQuestions.length - 1 ? "submit-btn" : "next-btn";
            container.innerHTML = `
                <h3 class="question-title">${currentQues.title}</h3>
                ${optionsHtml}
                <button class="${btnClass}" onclick="handleNext()">${btnText}</button>
            `;
        }

        // 处理下一题/提交逻辑
        function handleNext() {
            const currentQues = surveyQuestions[currentQuesIndex];
            const selectedOptions = document.querySelectorAll(`input[name="ques_${currentQues.id}"]:checked`);
            const tip = document.getElementById("tip");

            // 校验是否选择选项
            if (selectedOptions.length === 0) {
                tip.style.display = "block";
                setTimeout(() => tip.style.display = "none", 2000);
                return;
            }
            tip.style.display = "none";

            // 计算当前题得分 存储答案
            let currentScore = 0;
            let selectedLabels = [];
            selectedOptions.forEach(opt => {
                currentScore += parseInt(opt.value);
                selectedLabels.push(opt.nextElementSibling.innerText);
            });
            totalScore += currentScore;
            userAnswers.push({
                quesId: currentQues.id,
                quesTitle: currentQues.title,
                selected: selectedLabels,
                score: currentScore
            });

            // 最后一题则跳转结果页，否则渲染下一题
            if (currentQuesIndex === surveyQuestions.length - 1) {
                showResult();
                return;
            }
            currentQuesIndex++;
            renderCurrentQuestion();
        }

        // 显示结果页（评分+扇形图）
        function showResult() {
            document.getElementById("surveyContainer").style.display = "none";
            document.getElementById("resultPage").style.display = "block";
            const scoreText = document.getElementById("scoreText");
            // 总分评级（满分112分）
            let levelDesc = "";
            if (totalScore <= 25) levelDesc = "精神状态极佳，是校园里的清醒担当！";
            else if (totalScore <= 50) levelDesc = "精神状态良好，偶尔发疯属正常操作~";
            else if (totalScore <= 75) levelDesc = "精神状态告急，急需放假充电续命！";
            else if (totalScore <= 95) levelDesc = "精神状态濒危，随时随地准备阴暗爬行！";
            else levelDesc = "精神状态已放飞，逆天属性直接拉满！";
            scoreText.innerText = `你的逆天总得分：${totalScore}/112 分\n${levelDesc}`;
            
            // 生成随机占比 绘制扇形图
            const randomRate = Math.floor(Math.random() * 40) + 30; // 30-70随机占比
            const chartData = {
                labels: ["想死", "也是想死，不过是浅蓝色的"],
                datasets: [{
                    data: [randomRate, 100 - randomRate],
                    backgroundColor: ["#1f4e96", "#8cb4f5"], // 深蓝 浅蓝
                    borderWidth: 0
                }]
            };
            new Chart(document.getElementById("resultChart"), {
                type: "pie",
                data: chartData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: "bottom",
                            font: {size: 16},
                            labels: {padding: 20}
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>
